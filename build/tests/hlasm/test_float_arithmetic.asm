*
* Generated by CC Compiler - HLASM Backend
*
CCPROG   CSECT
         USING *,12
*
*
* Function: main
* Convenção z/OS: R1=param list, R13=save area, R14=return, R15=entry
*
main     DS    0H
         STM   14,12,12(13)      Save registers R14-R12
         LR    12,15             Establish base register
         USING main,12
         LR    11,13             Save caller's save area in R11
         LA    13,SAVEmain         Get our save area
         ST    11,4(,13)         Chain: our->prev = caller's
         ST    13,8(,11)         Chain: caller->next = ours
         LR    11,13             R11 = frame pointer (ebp)
*        R1 contains parameter list pointer
*        Parameters accessed via: L Rx,0(,1) for 1st, L Rx,4(,1) for 2nd, etc.
         AHI   13,-60
         LD    0,=DB'0'        Load double BFP constant
         STD   0,64(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,=DB'8'        Load double BFP constant
         STD   0,56(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,64(,11)        Load double BFP from stack
         ADB   0,56(,11)        Add double BFP from stack
         STD   0,48(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,64(,11)        Load double BFP from stack
         SDB   0,56(,11)        Sub double BFP from stack
         STD   0,40(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,64(,11)        Load double BFP from stack
         MDB   0,56(,11)        Mul double BFP from stack
         STD   0,32(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,64(,11)        Load double BFP from stack
         DDB   0,56(,11)        Div double BFP from stack
         STD   0,24(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,64(,11)        Load double BFP from stack
         LCDBR 0,0              Negate F0 (BFP)
         STD   0,16(,11)        Store double to stack
         LDR   2,0              Copy F0 to F2 (pop)
         LD    0,48(,11)        Load double BFP from stack
* FPU control word - not applicable to z/Arch
         CFDBR 0,5,0            Convert long BFP to fixed (truncate)
         ST    0,-4(,13)        Store integer to stack
         L     2,-4(,13)        Load from stack
* FPU control word - not applicable to z/Arch
         ST    2,12(,11)
         L     2,12(,11)
*        Return: R15 contains return code, F0 for float/double
         LR    15,2              Copy return value to R15
         L     13,4(,13)         Restore caller's save area
         LM    14,12,12(13)      Restore registers R14-R12
         BR    14                Return to caller
*
* Function: _main
* Convenção z/OS: R1=param list, R13=save area, R14=return, R15=entry
*
_main    DS    0H
         STM   14,12,12(13)      Save registers R14-R12
         LR    12,15             Establish base register
         USING _main,12
         LR    11,13             Save caller's save area in R11
         LA    13,SAVE_main         Get our save area
         ST    11,4(,13)         Chain: our->prev = caller's
         ST    13,8(,11)         Chain: caller->next = ours
         LR    11,13             R11 = frame pointer (ebp)
*        R1 contains parameter list pointer
*        Parameters accessed via: L Rx,0(,1) for 1st, L Rx,4(,1) for 2nd, etc.
         AHI   13,-4
*        Call function: main
         L     15,=V(main)      Load function address
         BALR  14,15            Call function
         LR    2,15             Copy return value to R2 (eax)
         ST    2,68(,11)
*        Return: R15 contains return code, F0 for float/double
         LR    15,2              Copy return value to R15
         L     13,4(,13)         Restore caller's save area
         LM    14,12,12(13)      Restore registers R14-R12
         BR    14                Return to caller
*
* Data Section
*
         DC    DB'100.500000'
         DC    DB'25.250000'
*
* Work Areas
*
SAVEAREA DS    18F               Register save area (72 bytes)
PLIST    DS    16F               Parameter list (up to 16 params)
FTEMP    DS    D                 Temp for float conversions
ITEMP    DS    F                 Temp for integer conversions
*
* Function-specific save areas
*
SAVEmain DS    18F               Save area for main
SAVE_main DS    18F               Save area for _main
*
         LTORG                   Literal pool
*
*--------------------------------------------------------------------
* Notas sobre instruções de conversão:
* CDFBR F1,R2 - Convert from Fixed 32-bit to Long BFP (double)
* CFDBR R1,M3,F2 - Convert to Fixed 32-bit from Long BFP
*   M3=0: Use current rounding mode
*   M3=1: Round to nearest (ties to even)
*   M3=5: Round toward zero (truncate)
*   M3=6: Round toward +infinity
*   M3=7: Round toward -infinity
* Estas instruções requerem z/Architecture (z900+)
*--------------------------------------------------------------------
         END   CCPROG
